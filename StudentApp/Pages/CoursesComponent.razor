@page "/my-courses"
@using Microsoft.AspNetCore.Components
@using Microsoft.AspNetCore.Components.Authorization
@using Student.Shared.Models.CourseManagement
@using StudentApp.Services.CourseService
@using System.Security.Claims

<PageTitle>My Courses</PageTitle>

<RadzenText TextStyle="TextStyle.H3" TagName="TagName.H1" class="rz-pt-8">
    Enrolled Courses
</RadzenText>
<RadzenText TextStyle="TextStyle.Subtitle1" class="rz-pb-4">
    View and manage your current course enrollments
</RadzenText>

<RadzenCard Variant="Variant.Outlined" class="rz-my-4">
    <RadzenDataGrid Data="@enrolledCourses"
    TItem="EnrolledCourseModelDTO"
    AllowFiltering="true"
    AllowColumnResize="true"
    AllowAlternatingRows="false"
    FilterMode="FilterMode.Advanced"
    AllowSorting="true"
    PageSize="10"
    AllowPaging="true"
    PagerHorizontalAlign="HorizontalAlign.Left"
    ShowPagingSummary="true"
    ColumnWidth="300px"
    LogicalFilterOperator="LogicalFilterOperator.Or">

        <Columns>
            <RadzenDataGridColumn TItem="EnrolledCourseModelDTO" Property="CourseCode" Title="Course Code" Frozen="true" Width="120px" />
            <RadzenDataGridColumn TItem="EnrolledCourseModelDTO" Property="CourseName" Title="Course Name" Width="250px" />
            <RadzenDataGridColumn TItem="EnrolledCourseModelDTO" Property="Instructor" Title="Instructor" Width="180px" />
            <RadzenDataGridColumn TItem="EnrolledCourseModelDTO" Property="Credits" Title="Credits" Width="100px" />
            <RadzenDataGridColumn TItem="EnrolledCourseModelDTO" Property="Schedule" Title="Schedule" Width="150px" />
            <RadzenDataGridColumn TItem="EnrolledCourseModelDTO" Property="EnrollmentDate" Title="Enrolled On" Width="120px" />

            <RadzenDataGridColumn TItem="EnrolledCourseModelDTO" Context="course" Filterable="false" Sortable="false"
            TextAlign="TextAlign.Center" Width="140px" Title="Actions">
                <Template Context="course">
                    <RadzenButton ButtonStyle="ButtonStyle.Danger"
                    Icon="remove_circle"
                    Size="ButtonSize.Small"
                    Shade="Shade.Lighter"
                    Text="Deregister"
                    Click=@(() => DeregisterFromCourse(course)) />
                </Template>
            </RadzenDataGridColumn>
        </Columns>
    </RadzenDataGrid>
</RadzenCard>

@if (enrolledCourses.Count == 0)
{
    <RadzenAlert AlertStyle="AlertStyle.Info" Variant="Variant.Flat" Shade="Shade.Lighter">
        You are not currently enrolled in any courses.
        <RadzenLink Path="/available-courses" Text="Browse available courses" /> to get started.
    </RadzenAlert>
}
