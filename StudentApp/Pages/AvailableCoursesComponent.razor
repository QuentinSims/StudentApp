@page "/available-courses"
@using Microsoft.AspNetCore.Components
@using Microsoft.AspNetCore.Components.Authorization
@using Student.Shared.Models.CourseManagement
@using StudentApp.Services.CourseService
@using System.Security.Claims

<PageTitle>Available Courses</PageTitle>

<RadzenText TextStyle="TextStyle.H3" TagName="TagName.H1" class="rz-pt-8">
    Available Courses
</RadzenText>
<RadzenText TextStyle="TextStyle.Subtitle1" class="rz-pb-4">
    Browse and register for available courses
</RadzenText>

<RadzenCard Variant="Variant.Outlined" class="rz-my-4">
    <RadzenDataGrid AllowFiltering="true" AllowColumnResize="true" AllowAlternatingRows="false" FilterMode="FilterMode.Advanced" AllowSorting="true" PageSize="10" AllowPaging="true" PagerHorizontalAlign="HorizontalAlign.Left" ShowPagingSummary="true"
    Data="@availableCourses" TItem="CourseModelDTO" ColumnWidth="300px" LogicalFilterOperator="LogicalFilterOperator.Or">
        <Columns>
            <RadzenDataGridColumn TItem="CourseModelDTO" Property="CourseCode" Title="Course Code" Frozen="true" Width="120px" />
            <RadzenDataGridColumn TItem="CourseModelDTO" Property="CourseName" Title="Course Name" Width="250px" />
            <RadzenDataGridColumn TItem="CourseModelDTO" Property="Instructor" Title="Instructor" Width="180px" />
            <RadzenDataGridColumn TItem="CourseModelDTO" Property="Credits" Title="Credits" Width="100px" />
            <RadzenDataGridColumn TItem="CourseModelDTO" Property="Schedule" Title="Schedule" Width="150px" />
            <RadzenDataGridColumn TItem="CourseModelDTO" Property="Department" Title="Department" Width="140px" />
            <RadzenDataGridColumn TItem="CourseModelDTO" Property="AvailableSeats" Title="Available Seats" Width="130px" />
            <RadzenDataGridColumn TItem="CourseModelDTO" Property="MaxSeats" Title="Max Seats" Width="110px" />
            <RadzenDataGridColumn TItem="CourseModelDTO" Context="course" Filterable="false" Sortable="false" TextAlign="TextAlign.Center" Width="120px" Title="Actions">
                <Template Context="course">
                    <RadzenButton ButtonStyle="ButtonStyle.Primary" Icon="add_circle" Size="ButtonSize.Small"
                    Click=@(() => RegisterForCourse(course)) Text="Register"
                    Disabled="@(course.AvailableSeats == 0 || IsAlreadyEnrolled(course))" />
                </Template>
            </RadzenDataGridColumn>
        </Columns>
    </RadzenDataGrid>
</RadzenCard>